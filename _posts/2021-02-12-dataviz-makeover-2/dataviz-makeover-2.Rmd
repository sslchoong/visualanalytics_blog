---
title: "DataViz Makeover 2"
description: |
  A makeover of a data visualisation on the willingness of the public towards Covid-19 vaccination. Data was obtained from Imperial College London YouGov Covid 19 Behaviour Tracker Data Hub hosted at Github (https://github.com/YouGov-Data/covid-19-tracker), with the focus on survey data collected in January 2021.
author:
  - name: Selene Choong
    url: https://www.linkedin.com/in/selenechoong/
date: 02-12-2021
output:
  distill::distill_article:
    self_contained: false
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

# 1.0  Critiques of Existing Visualisation with Suggested Improvements

```{r, echo=FALSE, message=FALSE}

knitr::include_graphics("images/Fig1_ExistingViz.png")
```

### Clarity

|S/N| Comments | Suggested Improvement |
|:-:| :------------------------------- | :------------------------------- |
| 1 | The order of the countries on the y-axis for both charts are not synchronised, making it difficult for the readers to match the corresponding country bars between the two charts. However, the use of sorting for the chart “% of strongly agreed to vaccination” makes it easier for readers to view the relative results across the countries. | Align the country order such that the values for each country are shown on the same row. Countries can be sorted in decreasing % of respondents who selected strongly agreed |
| 2 | The charts are showing the % of survey respondents who selected the respective response values. As the survey only polled a subset of the citizens within each country (i.e. sample) instead of all citizens (i.e. population), there would be some form of uncertainty associated with the values shown. However, the existing chart does not depict any uncertainty and readers might interpret the chart as showing the precise representation of the country’s true acceptance towards the vaccine. | Explore using statistical values to reflect the uncertainty associated with the survey results |
| 3 | The current chart title does not clearly describe the question being asked to capture the findings shown, which is only covering willingness to get the vaccine if available this week. Research also mainly utilised the survey data from interviews conducted in January 2021, but this timeframe was not shown in the data visualisation. | Revise the chart title to better represent the question asked as well as to reflect the timeframe of January 2021 within the data visualisation |
| 4 | Value labels for the left chart were kept to the original data labels which only indicated the textual label for rating 1 and rating 5 and keeping ratings 2 to 4 as the numeric label only. This might not be intuitive to the readers on what each number represents. | Recode the values to use textual labels instead (i.e. 1 as “Strongly agree”, 2 as “Agree”, 3 as “Neutral”, 4 as “Disagree” and 5 as “Strongly disagree”) |
| 5 | Scale of the x-axis of the two charts are not synchronised, causing the bars of the right chart to appear longer than the same value on the left chart. This might be misleading to the readers. | Synchronise the axis for all charts, particularly those that are side by side so that the scales of the charts are aligned |

### Aesthetics

|S/N| Comments | Suggested Improvement |
|:-:| :------------------------------- | :------------------------------- |
| 6 | Current position of the legend makes it difficult for the readers to match the value with its corresponding colour. Also, the title of the legend is showing the variable name instead of a related name to the chart and might confuse readers on whether the legend is meant for the left chart. | Legend should be shown near to the chart to allow easy matching of the values. Should legend title be required, it should be renamed to a related name to the chart |
| 7 | While the colour coding used for the chart on “Which country is more pro-vaccine” allows readers to distinctly identify the different categories, it does not depict the relativity of the labels that the finding is on a rating scale. | Revise the colour to show “Strongly agree” and “Agree” to use the same colour of different gradation. Likewise, “Strongly disagree” and “Disagree” will be shown with the same colour of different gradation as well |
| 8 | Coordinated use of blue colour for “Strongly agree” across the two charts allows for readers to better infer that the right chart might be showing a related value to the blue bar within the stacked chart of the left chart. | Coordinated use of colours can be adopted where applicable |
| 9 | Inconsistent x-axis labels across the two charts, where the x-axis labels for the left chart is shown as whole number while the right chart us shown to 1 decimal place | Standardise the number of decimal places across all the axis |
| 10 | Country labels are currently shown in full lowercase and with hyphens in the positions of the spaces. This might not be the best way to depict the country names. | Change the country names into proper case format and replace hyphens with space |


# 2.0  Ways to Improve Current Visualisation

### Sketch of Proposed Design

```{r, echo=FALSE, message=FALSE}

knitr::include_graphics("images/Fig2_Sketch.jpg")
```

-	Additional charts depicting data collected for other fields and the presence of on-demand parameters allow readers to deep dive further into the survey results, as well as to identify if there are any differences between the various segments instead of only comparing at the overall level.
-	Bar charts are kept to show the proportions of respondents within each country that have selected each of the response option. To further improve the ease of comparison, stacked bar charts are adopted that aligns the disagree vs agree.
- Error bars are added to show the uncertainty associated with survey data, and the range of findings at the various confidence levels. 


# 3.0  Step-by-step Description on Preparation

## 3.1 Data Source

Data used for this visualisation can be downloaded from [Imperial College London YouGov Covid 19 Behaviour Tracker Data Hub](https://github.com/YouGov-Data/covid-19-tracker). While the entire data hosted on Github contains survey results for 30 countries, only the datasets for the following 14 countries were used: Australia, Canada, Denmark, Finland, France, Germany, Italy, Japan, Netherlands, Norway, Singapore, South Korea, Sweden and United Kingdom.

## 3.2 Data Preparation

### Data Inspection of the Data Files for 14 Countries

- Inspecting the data showed that there are numerous other field columns that were not applicable for the research, as well as data rows that were out of the Jan 2021 timeframe of interest <br>
![](images/1.1.jpg){width=100%}
- The codebook showed that all the datasets have the same variable fields (i.e. same header)
- There were some observed inconsistencies in the coding for some variables (e.g. 
)

### Concatenating Multiple Datasets in Tableau

- Launch Tableau. Under Connect to a File, click Text File <br>
![](images/2.1.png){width=30%}
- Navigate to the file directory where the data is saved. Select the one of the country data files (e.g. australia)
-	Remove the Logical Table of Australia from the Data Source Selection pane <br>
![](images/2.2.png){width=100%}
- Double click on New Union under the Files pane on the left <br>
![](images/2.3.png){width=30%}
- In the popup “Union” window, drag in the datasets for all 14 countries from the left pane and click OK to merge rows from all datasets into one <br>
![](images/2.4.png){width=50%}

### Filtering Master Data to Keep Relevant Data

- Click on Sheet 1 to add a new worksheet <br>
![](images/3.1.png){width=40%}
- Drag the dimensions and measures for all the data fields of interest (Vac 1, Vac2_1, Vac2_2, Vac2_3, Vac2_6, Vac_3, Gender, Age, Household Size, Household Children, Employment Status) as well as country (i.e. Table Name) under the rows. For employment status, include all the relevant dimensions i.e. Employment Status, Employment Status 1, Employment Status 2 etc. <br>
![](images/3.2.png){width=100%}

- Drag [RecordNo] under Detail of the All Marks Pane to keep the data at the individual respondent record level <br>
![](images/3.3.png){width=30%}
- Drag endtime under Filters cart and select range of dates, then indicate 1 Jan 2021 12AM as the start date and 31 Jan 2021 11.59PM as the end date to only keep data in Jan 2021 <br>
![](images/3.4.png){width=100%}
-	Click Analysis > View Data. In the popup “View Data” window, click the Export All button to save this filtered set of data as a new file (saved as consolidated_jan21 in this case) <br>
![](images/3.5.png){width=80%}
- Close the current Tableau session

### Data Cleaning for Extracted Data in Tableau

- Launch a new Tableau session. Navigate to the directory on computer drive with the file “consolidated_jan2021” and drag the file into Tableau to connect the data  
- Click on Sheet 1 to add a new worksheet <br>
![](images/3.1.png){width=40%}
-	Several new fields will be created to tidy up the existing data format. To create new field, click Analysis > Create Calculated Field. Rename the new field with text under "Field Name" column and input the formula under "Formula" column and click OK. Repeat this step for each of the new fields listed in the table below

|S/N| Field Name | Formula | Purpose |
|:-:| :----- | :-------------------------- | :--------------------- |
| 1 | Country | **REPLACE(REPLACE([Table Name], ".csv", ""), "-", " ")** | Remove the file extension and replace hyphens with space in the Table Name field which contains the country labels |
| 2 | Country Format | **TRIM(UPPER(LEFT(SPLIT([Country], " ", 1), 1)) + MID(SPLIT([Country], " ", 1), 2) + " " + UPPER(LEFT(SPLIT([Country], " ", 2), 1)) + MID(SPLIT([Country], " ", 2), 2))** | Proper case the country names i.e. capitalise the first letter of each word |
| 3 | Age Band | **IF [Age] <= 29 THEN "18 - 29" <br> ELSEIF [Age] <= 39 THEN "30 - 39" <br> ELSEIF [Age] <= 49 THEN "40 - 49" <br> ELSEIF [Age] <= 59 THEN "50 - 59" <br> ELSEIF [Age] >= 69 THEN "69 and above" <br> END **| Create age bands for comparison |
| 4 | Employment Status Format | **IF [Employment Status 1] = "Yes" THEN "Full time employment" <br> ELSEIF [Employment Status 2] = "Yes" THEN "Part time employment" <br> ELSEIF [Employment Status 3] = "Yes" THEN "Full time student" <br> ELSEIF [Employment Status 4] = "Yes" THEN "Retired" <br> ELSEIF [Employment Status 5] = "Yes" THEN "Unemployed" <br> ELSEIF [Employment Status 6] = "Yes" THEN "Not working" <br> ELSEIF [Employment Status 7] = "Yes" THEN "Other" <br> ELSE [Employment Status] END ** | Standardise format and recode all employment status into 1 consolidated field |

- Toggle to the pill of [Household Size] under the left Tables pane and click on the dropdown button to the right of the pill. Select Convert to Dimension as aliases can only be added for categorical data <br>
![](images/4.1.png){width=50%} <br>
- Toggle back to the pill of [Household Size] and click on the dropdown button again. Select Aliases. Type the recoded labels for the options “8” as “8 or more” and Null as “Undisclosed” under the “Value (Alias)” column and click OK <br>
![](images/4.2.png){width=60%} <br>
- As the data under the field of [Household Children] does not match with the codebook making it difficult to determine if the data captured are absolute quantitative responses or codes of qualitative responses, the field will not be used for subsequent visualisation steps

## 3.3 Creating Diverging Stacked Bar Chart

### Pivoting Data into Required Format

-	On Data Source tab, select the columns of the 6 data fields (Vac 1, Vac2_1, Vac2_2, Vac2_3, Vac2_6, Vac_3). Toggle to the top right of one of the selected column and click on the dropdown button. Select Pivot <br>
![](images/5.1.png){width=60%} <br>

-	Scroll to the pivoted resulting columns. Rename [Pivot Field Names] to “Question Code” and [Pivot Field Values] to “Question Response”

### Creating the Required Fields

-	Click on Sheet 1 to add a new worksheet <br>
![](images/6.1.png){width=40%} <br>

-	Toggle to the pill of [Question Response] under the left Tables pane and click on the dropdown button to the right of the pill. Select Aliases <br>
![](images/6.2.png){width=50%} <br>
Type the textual labels for the options under the “Value (Alias)” column and click OK. This helps to add proper text labels to the fields for display in the visulisation <br>
![](images/6.3.png){width=60%} <br>
-	Several new calculated fields will be created for generating the diverging stacked bar chart. To create new field, click Analysis > Create Calculated Field. Rename the new field with text under "Field Name" column and input the formula under "Formula" column and click OK. Repeat this step for each of the new fields listed in the table below

|S/N| Field Name | Formula | Purpose |
|:-:| :-------- | :-------------------------- | :--------------------- |
| 1 | Number of Records | **1** | Create an artificial column on the count for ease of tabulation |
| 2 | Total Count | **TOTAL(SUM([Number of Records]))** | Create a total variable as the base |
| 3 | Count Negative | **IF [Question Response] = "5 – Strongly disagree" OR [Question Response] = "4" THEN 1 <br> ELSEIF [Question Response] = "3" THEN 0.5 <br> ELSE 0 END** | Calibrate the diverging scale |
| 4 | Total Count Negative | **TOTAL(SUM([Count Negative]))** | Create a total negative variable for generating starting point |
| 5 | Percentage | **SUM([Number of Records])/ [Total Count]** | Compute the percentages |
| 6 | Gantt Start | **-[Total Count Negative]/ [Total Count]** | Create a starting point for the gantt chart    |
| 7 | Gantt Percentage | **PREVIOUS_VALUE([Gantt Start]) + ZN(LOOKUP([Percentage], -1))** | Create the percent for the gantt chart |

### Generating the Chart

-	From the left Tables pane, drag [Country Format] to Rows and [Gantt Percentage] under Columns <br>
![](images/7.1.png){width=50%} <br>
-	Drag [Question Response] from the left Tables pane to Detail under the Marks cart <br>
![](images/7.2.png){width=50%} <br>
-	Toggle to [Gantt Percentage] under Columns and click on the dropdown button to the right of the pill. Select Compute Using > Question Response <br>
![](images/7.3.png){width=50%} <br>
-	Drag [Question Response] from the left Tables pane to Color under the Marks cart <br>
![](images/7.4.png){width=50%} <br>
-	Under the Marks cart, click on the dropdown button and change the marks type to Gantt Bar <br>
![](images/7.5.png){width=30%} <br>
-	Drag [Percentage] from the left Tables pane to Size under the Marks cart <br>
![](images/7.6.png){width=50%} <br>
-	Click on the dropdown button at the top right of the Legend of [Question Response] and select Sort. Under Sort By, select Manual from the list. Sort the labels using the arrows at the right into the order of Strongly disagree, Disagree, Neutral, Agree and Strongly agree <br>
![](images/7.7.png){width=40%} <br>
-	Under the left Tables pane, right-click [Question Code], and select Create > Set <br>
![](images/7.8.png){width=50%} <br>
-	Under the popup “Create Set” window, check all options that should appear in the final filter card (i.e. Vac 1 and Vac 3). Rename the Set as Timeframe. Click OK <br>
![](images/7.9.png){width=50%} <br>
-	Drag [Timeframe] to the Filter shelf <br>
![](images/7.10.png){width=50%} <br>
-	Toggle to [Timeframe] under Filter shelf and click on the dropdown button to the right of the pill. Select Show Filter <br>
![](images/7.11.png){width=30%} <br>
-	Click on the dropdown button at the top right of the Timeframe Filter. Select Single Value (list) <br>
![](images/7.12.png){width=30%} <br>
-	Toggle to the pill of [Question Code] under the left Tables pane and click on the dropdown button to the right of the pill. Select Aliases <br>
![](images/7.13.png){width=50%} <br>
- Type the question labels for “Vac 1” as “This Week” and “Vac 3” as “A Year from Now” under the “Value (Alias)” column and click OK <br>
![](images/7.14.png){width=50%} <br>
-	Click on the dropdown button at the top right of the Question Response Legend. Select Edit Colors. Change the colours of each category. The following colours were used for this dashboard: <br>
*Strongly disagree – #aa0000; Disagree – #f5715d; Neutral – #b3b7b8; Agree – #92c0df; Strongly agree – #4e79a7* <br>
![](images/7.15.png){width=60%} <br>
- Click on the dropdown button at the top right of the Question Response Legend once more. Select Edit Title and change it to “Level of Agreement”
- Right click on the x-axis and select Add Reference Line
-	In the popup “Edit Reference Line, Band or Box” window, change the value to Constant and indicate 0. Change the label to None and make the preferred formatting for Line <br>
![](images/7.16.png){width=50%} <br>
-	Right click on the x-axis again and untick Show Header to hide the x-axis
- Right click on the Sheet 1 tab on the bottom bar and select Rename. Rename the sheet to Diverging Chart




# 4.0  Final Data Visualisation Output

```{r, echo=FALSE, message=FALSE, layout="l-body-outset"}


```

**Link to Tableau Dashboard:**


# 5.0  Major Observations



